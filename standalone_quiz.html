<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz: À Hora de Pôr a Mesa - Standalone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- Load React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Load Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Load Lucide Icons (Script version for globals) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #111827;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        // Lucide icons are often available as window.lucide.icons or similar if loaded via script, 
        // but simpler to use SVG strings or a lightweight icon component if widely used.
        // For this standalone, we'll try accessing them from global lucide object if available,
        // or define simple fallbacks to avoid crashes.

        const IconWrapper = ({ name, className }) => {
            if (window.lucide && window.lucide.icons && window.lucide.icons[name]) {
                // Lucide's script usually creates elements on DOM load for <i> tags, 
                // but for React usage without a bundler, we might need a workaround.
                // Let's use simple SVG replacements for the specific icons used to ensure it works.
                return null;
            }
            return null;
        };

        // Inline SVGs for reliability in standalone mode
        const CheckCircle2 = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10" /><path d="m9 12 2 2 4-4" /></svg>
        );
        const XCircle = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10" /><path d="m15 9-6 6" /><path d="m9 9 6 6" /></svg>
        );
        const TimerIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="10" x2="14" y1="2" y2="2" /><line x1="12" x2="15" y1="14" y2="11" /><circle cx="12" cy="14" r="8" /></svg>
        );
        const ArrowRight = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14" /><path d="m12 5 7 7-7 7" /></svg>
        );
        const Trophy = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" /><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" /><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" /></svg>
        );
        const RotateCcw = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" /><path d="M3 3v5h5" /></svg>
        );

        // --- DATA ---
        const quizQuestions = [
            {
                id: 1,
                question: "Quem é o autor do poema 'À hora de pôr a mesa, éramos cinco'?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "José Saramago", isCorrect: false },
                    { id: 'b', text: "Fernando Pessoa", isCorrect: false },
                    { id: 'c', text: "José Luís Peixoto", isCorrect: true },
                    { id: 'd', text: "Luís de Camões", isCorrect: false }
                ]
            },
            {
                id: 2,
                question: "Onde nasceu o autor José Luís Peixoto?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "Lisboa", isCorrect: false },
                    { id: 'b', text: "Galveias", isCorrect: true },
                    { id: 'c', text: "Porto", isCorrect: false },
                    { id: 'd', text: "Coimbra", isCorrect: false }
                ]
            },
            {
                id: 3,
                question: "Qual é o tema principal da obra 'A Criança em Ruínas'?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "A Guerra Colonial", isCorrect: false },
                    { id: 'b', text: "A revolução industrial", isCorrect: false },
                    { id: 'c', text: "A política moderna", isCorrect: false },
                    { id: 'd', text: "A nostalgia", isCorrect: true }
                ]
            },
            {
                id: 4,
                question: "Quanto à estrutura externa, quantos versos tem o poema?",
                timeLimit: 15,
                options: [
                    { id: 'a', text: "15 Versos", isCorrect: true },
                    { id: 'b', text: "10 Versos", isCorrect: false },
                    { id: 'c', text: "20 Versos", isCorrect: false },
                    { id: 'd', text: "12 Versos", isCorrect: false }
                ]
            },
            {
                id: 5,
                question: "Quais são os principais recursos expressivos utilizados no poema?",
                timeLimit: 30,
                options: [
                    { id: 'a', text: "Metáfora e Hipérbole", isCorrect: false },
                    { id: 'b', text: "Enumeração e Anáfora", isCorrect: true },
                    { id: 'c', text: "Ironia e Sarcasmo", isCorrect: false },
                    { id: 'd', text: "Personificação e Aliteração", isCorrect: false }
                ]
            },
            {
                id: 6,
                question: "Qual prémio literário ganhou José Luís Peixoto em 2001?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "Prémio Camões", isCorrect: false },
                    { id: 'b', text: "Prémio Nobel", isCorrect: false },
                    { id: 'c', text: "Prémio José Saramago", isCorrect: true },
                    { id: 'd', text: "Prémio Pessoa", isCorrect: false }
                ]
            },
            {
                id: 7,
                question: "Qual elemento do poema simboliza a união familiar, mesmo perante a ausência?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "A Mesa", isCorrect: true },
                    { id: 'b', text: "A Janela", isCorrect: false },
                    { id: 'c', text: "O Relógio", isCorrect: false },
                    { id: 'd', text: "A Porta", isCorrect: false }
                ]
            },
            {
                id: 8,
                question: "Na estrutura interna, o que representa a mudança de 'éramos cinco' para 'somos cinco'?",
                timeLimit: 30,
                options: [
                    { id: 'a', text: "A chegada de novos filhos", isCorrect: false },
                    { id: 'b', text: "A permanência da memória apesar da morte", isCorrect: true },
                    { id: 'c', text: "Um erro de contagem", isCorrect: false },
                    { id: 'd', text: "A visita de vizinhos", isCorrect: false }
                ]
            },
            {
                id: 9,
                question: "Que recurso expressivo é evidente no verso 'éramos cinco, somos cinco'?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "Antítese", isCorrect: true },
                    { id: 'b', text: "Anáfora", isCorrect: false },
                    { id: 'c', text: "Metáfora", isCorrect: false },
                    { id: 'd', text: "Personificação", isCorrect: false }
                ]
            },
            {
                id: 10,
                question: "A quem é dirigido o poema quando o sujeito diz 'o teu lugar'?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "Ao pai falecido", isCorrect: true },
                    { id: 'b', text: "À mãe", isCorrect: false },
                    { id: 'c', text: "A um irmão ausente", isCorrect: false },
                    { id: 'd', text: "Ao próprio poeta", isCorrect: false }
                ]
            },
            {
                id: 11,
                question: "Qual é o tom emocional predominante no poema?",
                timeLimit: 20,
                options: [
                    { id: 'a', text: "Melancolia e Saudade", isCorrect: true },
                    { id: 'b', text: "Alegria e Euforia", isCorrect: false },
                    { id: 'c', text: "Raiva e Revolta", isCorrect: false },
                    { id: 'd', text: "Indiferença e Frieza", isCorrect: false }
                ]
            }
        ];

        // --- TYPES MOCK (Not needed in JS but for structure) ---
        const GameState = {
            START: 'START',
            PLAYING: 'PLAYING',
            FEEDBACK: 'FEEDBACK',
            RESULT: 'RESULT'
        };

        // --- COMPONENTS ---

        // 1. StartScreen
        const StartScreen = ({ onStart }) => {
            return (
                <div className="flex flex-col items-center justify-center min-h-screen text-center p-6 animate-fade-in relative overflow-hidden bg-gradient-to-br from-gray-900 via-gray-800 to-black">
                    {/* Background shapes */}
                    <div className="absolute top-20 left-20 w-32 h-32 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob"></div>
                    <div className="absolute bottom-20 right-20 w-32 h-32 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-2000"></div>

                    <div className="relative z-10 bg-gray-800/50 backdrop-blur-lg p-12 rounded-3xl shadow-2xl border border-gray-700/50">
                        <div className="mb-8">
                            <h1 className="text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 mb-4 drop-shadow-sm">
                                QUIZ
                            </h1>
                            <h2 className="text-xl md:text-2xl font-light tracking-widest text-gray-300 uppercase border-b-2 border-purple-500 pb-2 inline-block">
                                Da Hora de Pôr a Mesa
                            </h2>
                        </div>

                        <p className="text-gray-400 mb-10 text-lg max-w-md mx-auto leading-relaxed">
                            Teste o seu conhecimento sobre o poema de <strong className="text-white">José Luís Peixoto</strong>.
                        </p>

                        <button
                            onClick={onStart}
                            className="group relative inline-flex items-center justify-center px-8 py-4 font-bold text-white transition-all duration-200 bg-purple-600 font-lg rounded-full hover:bg-purple-700 hover:shadow-lg hover:shadow-purple-500/30 hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-600 active:scale-95"
                        >
                            <span className="mr-2">Iniciar Quiz</span>
                            <svg className="w-5 h-5 transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                            </svg>
                        </button>
                    </div>

                    <div className="mt-8 text-xs text-gray-600 uppercase tracking-widest">
                        Feito com React & Tailwind
                    </div>
                </div>
            );
        };

        // 2. ResultScreen
        const ResultScreen = ({ score, totalQuestions, onRestart }) => {
            const percentage = Math.round((score / totalQuestions) * 100);
            let message = '';
            let color = '';

            if (percentage === 100) {
                message = 'Fantástico! Poeta nato!';
                color = 'text-green-400';
            } else if (percentage >= 70) {
                message = 'Muito Bom! Conheces bem a obra.';
                color = 'text-blue-400';
            } else if (percentage >= 50) {
                message = 'Razoável. Vale a pena reler o poema.';
                color = 'text-yellow-400';
            } else {
                message = 'Ops! Tenta outra vez.';
                color = 'text-red-400';
            }

            return (
                <div className="flex flex-col items-center justify-center min-h-screen p-6 bg-gray-900 text-white text-center">
                    <div className="bg-gray-800 p-8 md:p-12 rounded-2xl shadow-2xl border border-gray-700 max-w-2xl w-full">
                        <div className="mb-6 flex justify-center">
                            <Trophy className={`w-24 h-24 ${color} drop-shadow-lg`} />
                        </div>

                        <h2 className="text-4xl md:text-5xl font-black mb-2 uppercase">Resultado Final</h2>
                        <p className={`text-xl md:text-2xl font-bold mb-8 ${color}`}>{message}</p>

                        <div className="bg-gray-700/50 rounded-xl p-8 mb-8 backdrop-blur-sm">
                            <div className="text-6xl font-black mb-2 flex items-baseline justify-center gap-2">
                                <span className={color}>{score}</span>
                                <span className="text-3xl text-gray-400">/ {totalQuestions}</span>
                            </div>
                            <div className="w-full bg-gray-600 rounded-full h-4 mt-4 overflow-hidden">
                                <div
                                    className={`h-full transition-all duration-1000 ease-out ${percentage >= 50 ? 'bg-green-500' : 'bg-red-500'}`}
                                    style={{ width: `${percentage}%` }}
                                ></div>
                            </div>
                            <p className="mt-2 text-gray-400">{percentage}% de acerto</p>
                        </div>

                        <button
                            onClick={onRestart}
                            className="flex items-center gap-2 mx-auto bg-white text-gray-900 px-8 py-3 rounded-full font-bold text-lg hover:bg-gray-200 hover:scale-105 transition-all shadow-lg"
                        >
                            <RotateCcw className="w-5 h-5" />
                            Jogar Novamente
                        </button>
                    </div>
                </div >
            );
        };

        // 3. QuizScreen
        const QuizScreen = ({
            question,
            currentQuestionIndex,
            totalQuestions,
            onAnswer,
            onNext
        }) => {
            const [timeLeft, setTimeLeft] = useState(question.timeLimit);
            const [selectedOptionId, setSelectedOptionId] = useState(null);
            const [isAnswered, setIsAnswered] = useState(false);
            const [isCorrect, setIsCorrect] = useState(false);

            const optionColors = [
                'bg-red-500 hover:bg-red-600 shadow-[0_4px_0_rgb(185,28,28)]',
                'bg-blue-500 hover:bg-blue-600 shadow-[0_4px_0_rgb(29,78,216)]',
                'bg-yellow-500 hover:bg-yellow-600 shadow-[0_4px_0_rgb(161,98,7)]',
                'bg-green-500 hover:bg-green-600 shadow-[0_4px_0_rgb(21,128,61)]'
            ];

            const optionShapes = ['▲', '◆', '●', '■'];

            useEffect(() => {
                if (isAnswered) return;

                const timer = setInterval(() => {
                    setTimeLeft((prev) => {
                        if (prev <= 0) {
                            clearInterval(timer);
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                return () => clearInterval(timer);
            }, [isAnswered]);

            useEffect(() => {
                if (timeLeft === 0 && !isAnswered) {
                    handleTimeOut();
                }
            }, [timeLeft, isAnswered]);

            const handleTimeOut = () => {
                setIsAnswered(true);
                setIsCorrect(false);
                onAnswer(false);
            };

            const handleOptionClick = (option) => {
                if (isAnswered) return;

                setSelectedOptionId(option.id);
                setIsAnswered(true);
                const correct = option.isCorrect;
                setIsCorrect(correct);
                onAnswer(correct);
            };

            if (isAnswered) {
                return (
                    <div className={`flex flex-col items-center justify-center min-h-screen p-6 text-white text-center transition-colors duration-500 ${isCorrect ? 'bg-green-700' : 'bg-red-700'}`}>
                        <div className="mb-6 animate-bounce">
                            {isCorrect ? (
                                <CheckCircle2 className="w-24 h-24 text-white" />
                            ) : (
                                <XCircle className="w-24 h-24 text-white" />
                            )}
                        </div>

                        <h2 className="text-5xl font-black mb-4 uppercase drop-shadow-md">
                            {isCorrect ? "Correto!" : "Errado!"}
                        </h2>

                        {!isCorrect && (
                            <div className="mb-8 bg-black/40 p-6 rounded-xl border border-white/10">
                                <p className="opacity-80 text-sm uppercase font-bold mb-2">A resposta correta era:</p>
                                <p className="text-2xl font-bold">{question.options.find(o => o.isCorrect)?.text}</p>
                            </div>
                        )}

                        <div className="bg-black/30 px-6 py-3 rounded-full font-bold text-xl mb-8 backdrop-blur-sm border border-white/10">
                            +{isCorrect ? (timeLeft * 10) + 50 : 0} Pontos
                        </div>

                        <button
                            onClick={onNext}
                            className="flex items-center gap-2 bg-white text-gray-900 px-8 py-4 rounded-lg font-black text-xl hover:bg-gray-100 hover:scale-105 transition-all shadow-lg"
                        >
                            Próxima <ArrowRight className="w-6 h-6" />
                        </button>
                    </div>
                );
            }

            return (
                <div className="flex flex-col min-h-screen bg-gray-900 text-white">
                    <div className="bg-gray-800 p-4 flex justify-between items-center shadow-md border-b border-gray-700">
                        <span className="font-black text-gray-400 text-lg">
                            {currentQuestionIndex + 1} <span className="text-sm font-normal text-gray-500">/ {totalQuestions}</span>
                        </span>
                        <div className="flex items-center gap-2 font-bold text-gray-200 bg-gray-700 px-4 py-1 rounded-full border border-gray-600">
                            <TimerIcon className="w-4 h-4" />
                            Quiz Time
                        </div>
                    </div>

                    <div className="flex-1 flex flex-col items-center p-4 max-w-6xl mx-auto w-full">
                        <div className="bg-gray-800 rounded-xl shadow-2xl p-8 mb-6 w-full text-center flex-1 flex flex-col justify-center min-h-[300px] border border-gray-700">
                            <h2 className="text-3xl md:text-4xl font-bold text-gray-100 leading-tight">
                                {question.question}
                            </h2>

                            <div className="mt-8 flex justify-center">
                                <div className="relative w-20 h-20 flex items-center justify-center rounded-full bg-gray-700 shadow-inner">
                                    <svg className="absolute w-full h-full transform -rotate-90">
                                        <circle className="text-gray-600" strokeWidth="8" stroke="currentColor" fill="transparent" r="36" cx="40" cy="40" />
                                        <circle
                                            className={`transition-all duration-1000 ease-linear ${timeLeft < 5 ? 'text-red-500' : 'text-purple-500'}`}
                                            strokeWidth="8"
                                            strokeDasharray={226}
                                            strokeDashoffset={226 - (226 * timeLeft) / question.timeLimit}
                                            strokeLinecap="round"
                                            stroke="currentColor"
                                            fill="transparent"
                                            r="36"
                                            cx="40"
                                            cy="40"
                                        />
                                    </svg>
                                    <span className={`text-2xl font-black ${timeLeft < 5 ? 'text-red-400' : 'text-white'}`}>{timeLeft}</span>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 w-full">
                            {question.options.map((option, index) => (
                                <button
                                    key={option.id}
                                    onClick={() => handleOptionClick(option)}
                                    className={`${optionColors[index % 4]} text-white p-6 md:p-10 rounded-lg text-left transition-transform active:scale-95 active:translate-y-[4px] active:shadow-none flex items-center group border-b-4 border-black/20`}
                                >
                                    <div className="bg-black/20 w-12 h-12 flex items-center justify-center rounded-md mr-4 text-2xl font-bold flex-shrink-0 group-hover:bg-black/30 transition-colors">
                                        {optionShapes[index % 4]}
                                    </div>
                                    <span className="text-xl md:text-2xl font-bold leading-snug shadow-sm">{option.text}</span>
                                </button>
                            ))}
                        </div>
                    </div >
                </div >
            );
        };

        // 4. App
        function App() {
            const [gameState, setGameState] = useState(GameState.START);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [score, setScore] = useState(0);

            const startGame = () => {
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setScore(0);
            };

            const handleAnswer = (isCorrect) => {
                if (isCorrect) {
                    setScore(prev => prev + 1);
                }
            };

            const handleNextQuestion = () => {
                if (currentQuestionIndex < quizQuestions.length - 1) {
                    setCurrentQuestionIndex(prev => prev + 1);
                    setGameState(GameState.PLAYING);
                } else {
                    setGameState(GameState.RESULT);
                }
            };

            const restartGame = () => {
                setGameState(GameState.START);
                setScore(0);
                setCurrentQuestionIndex(0);
            };

            return (
                <div className="min-h-screen bg-gray-900 font-sans text-white">
                    {gameState === GameState.START && (
                        <StartScreen onStart={startGame} />
                    )}

                    {(gameState === GameState.PLAYING || gameState === GameState.FEEDBACK) && (
                        <QuizScreen
                            key={currentQuestionIndex}
                            question={quizQuestions[currentQuestionIndex]}
                            currentQuestionIndex={currentQuestionIndex}
                            totalQuestions={quizQuestions.length}
                            onAnswer={handleAnswer}
                            onNext={handleNextQuestion}
                        />
                    )}

                    {gameState === GameState.RESULT && (
                        <ResultScreen
                            score={score}
                            totalQuestions={quizQuestions.length}
                            onRestart={restartGame}
                        />
                    )}
                </div>
            );
        }

        // 5. Mount
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>